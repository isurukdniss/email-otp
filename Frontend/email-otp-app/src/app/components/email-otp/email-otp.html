<div>
    <h2>Email OTP Tester</h2>
    @if (!isOtpSent()) { 
        <div>
            <form [formGroup]="generateOtpForm" (ngSubmit)="onGenerateOtpSubmit()">
            <div class="form-group">
                <label for="email">Email Address</label>
                <input id="email" type="email" formControlName="email" placeholder="Enter your @dso.org.sg email">
            </div>
            <button type="submit" [disabled]="isLoading() || generateOtpForm.invalid">
                {{ isLoading() ? 'Sending...' : 'Send OTP' }}
            </button>
            </form>
        </div>
    
    } @else {
        <div>
            <form [formGroup]="verifyOtpForm" (ngSubmit)="onVerifyOtpSubmit()">
              <div class="form-group">
                <label for="verify-email">Email Address</label>
                <input id="verify-email" type="email" formControlName="email">
              </div>
              <div class="form-group">
                <label for="otp">One-Time Password</label>
                <input id="otp" type="text" formControlName="otp" placeholder="Enter 6-digit code" maxlength="6">
                @if (verifyOtpForm.get('otp')?.invalid && verifyOtpForm.get('otp')?.touched) {
                  <small>Please enter the 6-digit OTP.</small>
                }
              </div>
              <button type="submit" [disabled]="isLoading() || verifyOtpForm.invalid">
                 {{ isLoading() ? 'Verifying...' : 'Verify Code' }}
              </button>
            </form>
             <a href="#" class="back-link" (click)="goBack()">Use a different email</a>
          </div>
    }
    @if (feedbackMessage()) {
        <div class="feedback" [ngClass]="{'error': isError(), 'success': !isError()}">
          {{ feedbackMessage() }}
        </div>
    }
</div>
